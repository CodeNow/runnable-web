machine:
  environment:
    NODE_ENV: circle
dependencies:
  override:
    - nvm install 0.10.10
    - nvm alias default 0.10.10
    - curl -sL --user "Runnable-Bot:pass4now20" https://github.com/CodeNow/api-server/tarball/v0.1.2 > api_server.tar.gz
    - tar -xvf api_server.tar.gz
    - mkdir ~/.runnable
    - mkdir ~/.runnable/volumes
    - cd CodeNow-api-server-c169d1710b70cca0a2ccd3f9cbc91170d78636f5; make install; make build; NODE_ENV=production make start &
    - npm install
    - rm -rf ./node_modules/rendr
    - npm install rendr
    - rvm use 1.9.3 default
    - gem install compass
    - ./node_modules/.bin/bower install
    - ./node_modules/.bin/grunt